<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ä¹—æ³•å…¬å¼ã‚²ãƒ¼ãƒ </title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #f0f0f0;
    }
    #container {
      max-width: 700px;
      margin: auto;
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    input[type="text"] {
      width: 300px;
      font-size: 16px;
    }
    button {
      font-size: 16px;
      margin-top: 10px;
      padding: 5px 10px;
    }
    h1 {
      color: #333;
    }
  </style>
</head>
<body>
  <div id="container">
    <h1>ä¹—æ³•å…¬å¼ã‚²ãƒ¼ãƒ </h1>
    <div id="question"></div>
    <input type="text" id="answer" placeholder="ä¾‹: 4xÂ²-6xy+9yÂ²">
    <br>
    <button onclick="checkAnswer()">ç­”ãˆã‚‹ï¼</button>
    <p id="result"></p>
    <p id="score">0å•æ­£è§£ä¸­</p>
  </div>

  <script>
    let questionCount = 0;
    let correctCount = 0;
    let correctExpansion = "";

    function generateQuestion() {
      const isSquare = Math.random() < 0.5;

      let questionText = "";
      if (isSquare) {
        const a = Math.floor(Math.random() * 9) + 1;
        const b = Math.floor(Math.random() * 9) + 1;
        const plus = Math.random() < 0.5;
        const op = plus ? "+" : "-";

        questionText = `Q${questionCount + 1}: ( ${a}x ${op} ${b}y )Â² ã‚’å±•é–‹ã—ã¦ï¼`;
        const a2 = a * a;
        const ab2 = 2 * a * b;
        const b2 = b * b;
        correctExpansion = plus
          ? `${a2}xÂ²+${ab2}xy+${b2}yÂ²`
          : `${a2}xÂ²-${ab2}xy+${b2}yÂ²`;

      } else {
        const a = Math.floor(Math.random() * 9) + 1;
        const b = Math.floor(Math.random() * 9) + 1;
        const c = Math.floor(Math.random() * 9) + 1;
        const d = Math.floor(Math.random() * 9) + 1;
        const plus1 = Math.random() < 0.5;
        const plus2 = Math.random() < 0.5;

        const op1 = plus1 ? "+" : "-";
        const op2 = plus2 ? "+" : "-";

        questionText = `Q${questionCount + 1}: ( ${a}x ${op1} ${b}y )( ${c}x ${op2} ${d}y ) ã‚’å±•é–‹ã—ã¦ï¼`;

        const ac = a * c;
        const ad = a * d;
        const bc = b * c;
        const bd = b * d;
        const mid = (plus1 ? 1 : -1) * ad + (plus2 ? 1 : -1) * bc;
        const signMid = mid >= 0 ? "+" : "-";
        const signLast = (plus1 === plus2) ? "+" : "-";

        correctExpansion = `${ac}xÂ²${signMid}${Math.abs(mid)}xy${signLast}${bd}yÂ²`;
      }

      document.getElementById("question").textContent = questionText;
    }

    function checkAnswer() {
      const userAnswer = document.getElementById("answer").value.replace(/\s+/g, "");
      const result = document.getElementById("result");

      if (userAnswer === correctExpansion) {
        result.textContent = "æ­£è§£ï¼ ğŸ‰";
        correctCount++;
      } else {
        result.textContent = `ä¸æ­£è§£ ğŸ˜¢ æ­£è§£ã¯ ${correctExpansion}`;
      }

      questionCount++;
      document.getElementById("score").textContent = `${questionCount}å•ä¸­ ${correctCount}å•æ­£è§£`;

      if (questionCount >= 10) {
        showResult();
      } else {
        document.getElementById("answer").value = "";
        generateQuestion();
      }
    }

    function showResult() {
      const accuracy = (correctCount / 10) * 100;
      if (confirm(`ãŠç–²ã‚Œã•ã¾ï¼\næ­£ç­”æ•°ï¼š${correctCount}/10\næ­£ç­”ç‡ï¼š${accuracy.toFixed(1)}%\nã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã—ã¾ã™ã‹ï¼Ÿ`)) {
        questionCount = 0;
        correctCount = 0;
        document.getElementById("answer").value = "";
        document.getElementById("result").textContent = "";
        document.getElementById("score").textContent = "0å•æ­£è§£ä¸­";
        generateQuestion();
      } else {
        alert("ã¾ãŸéŠã‚“ã§ã­ï¼");
      }
    }

    generateQuestion();
  </script>
</body>
</html>
